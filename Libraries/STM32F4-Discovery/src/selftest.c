/**
  ******************************************************************************
  * @file    selftest.c
  * @author  MCD Application Team
  * @version V1.0.0
  * @date    19-September-2011
  * @brief   This file provides the hardware tests
  ******************************************************************************
  * @attention
  *
  * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
  * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE
  * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY
  * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING
  * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE
  * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.
  *
  * <h2><center>&copy; COPYRIGHT 2011 STMicroelectronics</center></h2>
  */ 

/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include "FreeRTOS.h"
#include "selftest.h"
#include "stm32f4xx.h"

/* Exported macro ------------------------------------------------------------*/
#define ABS(x)         (x < 0) ? (-x) : x
#define MAX(a,b)       (a < b) ? (b) : a

/* Private typedef -----------------------------------------------------------*/
/* Private define ------------------------------------------------------------*/
#define MEMS_PASSCONDITION              10
///Cursor step imitation in USB DEVICE mode
#define CURSOR_STEP     1.0f
/* Private macro -------------------------------------------------------------*/
/* Private variables ---------------------------------------------------------*/
/* Init Structure definition */
RCC_ClocksTypeDef      RCC_Clocks;
ADC_InitTypeDef        ADC_InitStructure;
ADC_CommonInitTypeDef  ADC_CommonInitStructure;

__IO uint16_t ConvData1, ConvData2;
__IO uint16_t counter0 = 0, counter1 = 0, Idx = 0;
uint8_t ADC_Channel[2] = {ADC_Channel_2, ADC_Channel_3};
uint8_t DACTest = 0;
uint8_t GPIO_Pin[2] = {GPIO_Pin_2, GPIO_Pin_3};

uint16_t count = 0, count1 = 24, Left_Right = 0;

extern uint16_t RecBuf[];
extern int16_t audiodata[];

uint16_t sinebuf[SINE_BUF_SIZE] = {
//const uint16_t sinebuf[SINE_BUF_SIZE] = {
0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C,
0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640,
0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF,
0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592,
0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592,
0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF,
0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640,
0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C,
0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706,
0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE,
0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D,
0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8,
0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89,
0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81,
0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03,
0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275,
0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2,
0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB,
0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF,
0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C,
0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2,
0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000,
0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03,
0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C,
0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89,
0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB,
0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D,
0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275,
0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706,
0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81,
0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640,
0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8,
0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592,
0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE,
0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF,
0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C,
0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C,
0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF,
0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE,
0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592,
0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8,
0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640,
0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81,
0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706,
0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275,
0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D,
0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB,
0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89,
0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C,
0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03,
0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000,
0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2,
0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C,
0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF,
0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB,
0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2,
0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275,
0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03,
0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81,
0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89,
0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8,
0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D,
0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE,
0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706,

0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C,
0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640,
0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF,
0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592,
0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592,
0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF,
0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640,
0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C,
0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706,
0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE,
0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D,
0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8,
0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89,
0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81,
0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03,
0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275,
0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2,
0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB,
0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF,
0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C,
0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2,
0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000,
0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03,
0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C,
0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89,
0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB,
0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D,
0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275,
0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706,
0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81,
0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640,
0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8,
0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592,
0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE,
0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF,
0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C,
0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C,
0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF,
0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE,
0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592,
0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8,
0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640,
0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81,
0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706,
0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275,
0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D,
0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB,
0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89,
0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C,
0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03,
0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000,
0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2,
0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C,
0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF,
0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB,
0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2,
0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275,
0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03,
0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81,
0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89,
0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8,
0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D,
0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE,
0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706,

0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C,
0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640,
0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF,
0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592,
0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592,
0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF,
0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640,
0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C,
0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706,
0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE,
0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D,
0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8,
0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89,
0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81,
0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03,
0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275,
0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2,
0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB,
0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF,
0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C,
0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2,
0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000,
0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03,
0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C,
0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89,
0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB,
0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D,
0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275,
0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706,
0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81,
0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640,
0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8,
0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592,
0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE,
0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF,
0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C,
0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C,
0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF,
0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE,
0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592,
0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8,
0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640,
0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81,
0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706,
0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275,
0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D,
0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB,
0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89,
0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C,
0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03,
0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000,
0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2,
0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C,
0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF,
0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB,
0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2,
0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275,
0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03,
0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81,
0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89,
0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8,
0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D,
0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE,
0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706,

0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C,
0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640,
0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF,
0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592,
0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592,
0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF,
0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640,
0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C,
0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706,
0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE,
0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D,
0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8,
0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89,
0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81,
0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03,
0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275,
0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2,
0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB,
0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF,
0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C,
0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2,
0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000,
0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03,
0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C,
0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89,
0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB,
0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D,
0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275,
0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706,
0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81,
0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640,
0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8,
0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592,
0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE,
0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF,
0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C,
0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C,
0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF,
0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE,
0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592,
0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8,
0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640,
0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81,
0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706,
0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275,
0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D,
0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB,
0xB0FB, 0xC71C, 0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89,
0xFFFF, 0xFFFF, 0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C,
0xC71C, 0xB0FB, 0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03,
0x38E2, 0x38E2, 0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000,
0x0000, 0x0275, 0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2,
0x4F03, 0x4F03, 0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C,
0xC71C, 0xDA81, 0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF,
0xFD89, 0xFD89, 0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB,
0xB0FB, 0x98F8, 0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2,
0x257D, 0x257D, 0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275,
0x0275, 0x09BE, 0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03,
0x6706, 0x6706, 0x7FFF, 0x7FFF, 0x98F8, 0x98F8, 0xB0FB, 0xB0FB, 0xC71C, 0xC71C, 0xDA81,
0xDA81, 0xEA6C, 0xEA6C, 0xF640, 0xF640, 0xFD89, 0xFD89, 0xFFFF, 0xFFFF, 0xFD89, 0xFD89,
0xF640, 0xF640, 0xEA6C, 0xEA6C, 0xDA81, 0xDA81, 0xC71C, 0xC71C, 0xB0FB, 0xB0FB, 0x98F8,
0x98F8, 0x7FFF, 0x7FFF, 0x6706, 0x6706, 0x4F03, 0x4F03, 0x38E2, 0x38E2, 0x257D, 0x257D,
0x1592, 0x1592, 0x09BE, 0x09BE, 0x0275, 0x0275, 0x0000, 0x0000, 0x0275, 0x0275, 0x09BE,
0x09BE, 0x1592, 0x1592, 0x257D, 0x257D, 0x38E2, 0x38E2, 0x4F03, 0x4F03, 0x6706, 0x6706,

};

__IO uint32_t TimingDelay;

LIS302DL_InitTypeDef  LIS302DL_InitStruct;
LIS302DL_FilterConfigTypeDef LIS302DL_FilterStruct;

static uint8_t *USBD_HID_GetPos(void);

uint8_t Buffer[6];
/* Private function prototypes -----------------------------------------------*/
/* Private functions ---------------------------------------------------------*/
/**
  * @brief Test MEMS Hardware.
  *   The main objectif of this test is to check the hardware connection of the 
  *   MEMS peripheral.
  * @param None
  * @retval None
  */
void Accelerometer_MEMS_Test(void) {
	uint8_t temp, memsteststatus = 0x00;
	uint8_t xdata, ydata, zdata = 0;
	/* MEMS configuration ------------------------------------------------------*/
	/* Set configuration of LIS302DL*/
	LIS302DL_InitStruct.Power_Mode = LIS302DL_LOWPOWERMODE_ACTIVE;
	LIS302DL_InitStruct.Output_DataRate = LIS302DL_DATARATE_100;
	LIS302DL_InitStruct.Axes_Enable = LIS302DL_XYZ_ENABLE;
	LIS302DL_InitStruct.Full_Scale = LIS302DL_FULLSCALE_2_3;
	LIS302DL_InitStruct.Self_Test = LIS302DL_SELFTEST_NORMAL;
	LIS302DL_Init(&LIS302DL_InitStruct);
	/* Set configuration of Internal High Pass Filter of LIS302DL*/
	LIS302DL_FilterStruct.HighPassFilter_Data_Selection	= LIS302DL_FILTEREDDATASELECTION_OUTPUTREGISTER;
	LIS302DL_FilterStruct.HighPassFilter_CutOff_Frequency = LIS302DL_HIGHPASSFILTER_LEVEL_1;
	LIS302DL_FilterStruct.HighPassFilter_Interrupt = LIS302DL_HIGHPASSFILTERINTERRUPT_1_2;
	LIS302DL_FilterConfig(&LIS302DL_FilterStruct);
	/* Required delay for the MEMS Accelerometre: Turn-on time = 3/Output data Rate = 3/100 = 30ms */
	vTaskDelay(30 / portTICK_RATE_MS);
	/* Read WHO_AM_I register */
	LIS302DL_Read(&temp, LIS302DL_WHO_AM_I_ADDR, 1);
	/* Check device identification register, this register should contains
	 the device identifier that for LIS302DL is set to 0x3B */
	LIS302DL_Read(Buffer, LIS302DL_OUT_X_ADDR, 6);
	xdata = ABS((int8_t)(Buffer[0]));
	ydata = ABS((int8_t)(Buffer[2]));
	zdata = ABS((int8_t)(Buffer[4]));
	/* Check test PASS condition */
	if (((int8_t)(Buffer[0])) < MEMS_PASSCONDITION) {
		STM_EVAL_LEDOff(LED6);
		if (((int8_t)(Buffer[0])) < -MEMS_PASSCONDITION) {
			STM_EVAL_LEDOn(LED3);
		} else {
			STM_EVAL_LEDOff(LED3);
		}
	} else {
		STM_EVAL_LEDOn(LED6);
	}
	if (((int8_t)(Buffer[2])) < MEMS_PASSCONDITION) {
		STM_EVAL_LEDOff(LED5);
		if (((int8_t)(Buffer[2])) < -MEMS_PASSCONDITION) {
			STM_EVAL_LEDOn(LED4);
		} else {
			STM_EVAL_LEDOff(LED4);
		}
	} else {
		STM_EVAL_LEDOn(LED5);
	}
	if (zdata < MEMS_PASSCONDITION) {
		/* Turn LED8 ON using PD5 */
		GPIO_ResetBits(GPIOD, GPIO_Pin_5);
	} else {
		/* Turn LED8 OFF using PD5 */
		GPIO_SetBits(GPIOD, GPIO_Pin_5);
	}
	uint8_t *buf = USBD_HID_GetPos();
	if((buf[1] != 0) ||(buf[2] != 0)) {
		USBD_HID_SendReport(&USB_OTG_dev, buf, 4);
	}
}

/**
* @brief  USBD_HID_GetPos
* @param  None
* @retval Pointer to report
*/
static uint8_t *USBD_HID_GetPos(void) {
	static uint8_t HID_Buffer[4] = { 0 };
	HID_Buffer[1] = 0;
	HID_Buffer[2] = 0;
	/* UP Direction */
	if (((int8_t) Buffer[2]) < -MEMS_PASSCONDITION) {
		HID_Buffer[2] -= (uint8_t)(CURSOR_STEP * (ABS((int8_t) Buffer[2]) - MEMS_PASSCONDITION));
	}
	/* DOWN Direction */
	if (((int8_t) Buffer[2]) > MEMS_PASSCONDITION) {
		HID_Buffer[2] += (uint8_t)(CURSOR_STEP * (ABS((int8_t) Buffer[2]) - MEMS_PASSCONDITION));
	}
	/* RIGHT Direction */
	if (((int8_t) Buffer[0]) < -MEMS_PASSCONDITION) {
		HID_Buffer[1] += (uint8_t)(CURSOR_STEP * (ABS((int8_t) Buffer[0]) - MEMS_PASSCONDITION));
	}
	/* LEFT Direction */
	if (((int8_t) Buffer[0]) > MEMS_PASSCONDITION) {
		HID_Buffer[1] -= (uint8_t)(CURSOR_STEP * (ABS((int8_t) Buffer[0]) - MEMS_PASSCONDITION));
	}
	return HID_Buffer;
}

/**
  * @brief Test USB Hardware.
  *   The main objectif of this test is to check the hardware connection of the 
  *   Audio and USB peripheral.
  * @param None
  * @retval None
  */
void USB_Test(void) {
	GPIO_InitTypeDef GPIO_InitStructure;
	/******************************** USB Test **********************************/
	/*-------------------- with Audio USB cables connected  --------------------*/
	/* GPIOD Configuration: Pins 5 in output push-pull */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOD, &GPIO_InitStructure);
	/* Turn LED8 OFF using PD5 */
	GPIO_SetBits(GPIOD, GPIO_Pin_5);
	/* GPIOA Configuration: Pins 11, 12 in input pull-down */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11 | GPIO_Pin_12;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_DOWN;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	/* GPIOA Configuration: Pin 9 in output push-pull */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	GPIO_SetBits(GPIOA, GPIO_Pin_9);
	/* Waiting delay 10ms */
	vTaskDelay(10 / portTICK_RATE_MS);
	/* GPIOA Configuration: Pins 9, 12 in input pull-down */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9 | GPIO_Pin_12;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_DOWN;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	/* GPIOA Configuration: Pin 11 in output push-pull */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	GPIO_SetBits(GPIOA, GPIO_Pin_11);
	/* Waiting delay 10ms */
	vTaskDelay(10 / portTICK_RATE_MS);
	/* GPIOA Configuration: Pins 9, 11 in input pull-down */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9 | GPIO_Pin_11;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_DOWN;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	/* GPIOA Configuration: Pin 12 in output push-pull */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	GPIO_SetBits(GPIOA, GPIO_Pin_12);
	/* Waiting delay 10ms */
	vTaskDelay(10 / portTICK_RATE_MS);
	/* GPIOA Configuration: Pins 11, 12 in input pull-down */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11 | GPIO_Pin_12;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_DOWN;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	/* GPIOA Configuration: Pin 9 in output push-pull */
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_Init(GPIOA, &GPIO_InitStructure);
	/* Turn LED7 OFF using PA9 */
	GPIO_ResetBits(GPIOA, GPIO_Pin_9);
	/* Turn LED8 ON using PD5 */
	GPIO_ResetBits(GPIOD, GPIO_Pin_5);
}

/**
  * @brief Test Micophone MEMS Hardware.
  *   The main objectif of this test is to check the hardware connection of the 
  *   Microphone MEMS peripheral.
  * @param None
  * @retval None
  */
void Microphone_MEMS_Init(void) {
	I2S_InitTypeDef I2S_InitStructure;
	GPIO_InitTypeDef GPIO_InitStructure;
	/* Enable the SPI clock */
	RCC_APB1PeriphClockCmd(RCC_APB1Periph_SPI2, ENABLE);
	/* Enable GPIO clocks */
	RCC_AHB1PeriphClockCmd(SPI_SCK_GPIO_CLK | SPI_MOSI_GPIO_CLK, ENABLE);
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_25MHz;
	/* SPI SCK pin configuration */
	GPIO_InitStructure.GPIO_Pin = SPI_SCK_PIN;
	GPIO_Init(SPI_SCK_GPIO_PORT, &GPIO_InitStructure);
	/* Connect SPI pins to AF5 */
	GPIO_PinAFConfig(SPI_SCK_GPIO_PORT, SPI_SCK_SOURCE, SPI_SCK_AF);
	/* SPI MOSI pin configuration */
	GPIO_InitStructure.GPIO_Pin = SPI_MOSI_PIN;
	GPIO_Init(SPI_MOSI_GPIO_PORT, &GPIO_InitStructure);
	GPIO_PinAFConfig(SPI_MOSI_GPIO_PORT, SPI_MOSI_SOURCE, SPI_MOSI_AF);
	/* I2S configuration -------------------------------------------------------*/
	SPI_I2S_DeInit(SPI2);
	I2S_InitStructure.I2S_AudioFreq = I2S_AudioFreq_22k;
	I2S_InitStructure.I2S_Standard = I2S_Standard_MSB;
	I2S_InitStructure.I2S_DataFormat = I2S_DataFormat_16b;
	I2S_InitStructure.I2S_CPOL = I2S_CPOL_Low;
	I2S_InitStructure.I2S_Mode = I2S_Mode_MasterRx;
	I2S_InitStructure.I2S_MCLKOutput = I2S_MCLKOutput_Disable;
	/* Initialize the I2S peripheral with the structure above */
	I2S_Init(SPI2, &I2S_InitStructure);
	/* Enable the I2S peripheral */
	I2S_Cmd(SPI2, ENABLE);
	SPI2->CR2 |= SPI_CR2_RXNEIE;
}

/*--------------------------------
       Callbacks implementation:
           the callbacks prototypes are defined in the stm324xg_eval_audio_codec.h file
           and their implementation should be done in the user code if they are needed.
           Below some examples of callback implementations.
                                     --------------------------------------------------------*/
/**
  * @brief  Calculates the remaining file size and new position of the pointer.
  * @param  None
  * @retval None
  */
void EVAL_AUDIO_TransferComplete_CallBack ( uint32_t pBuffer, uint32_t Size ) {
	uint8_t i;
	/* Calculate the remaining audio data in the file and the new size
	 * for the DMA transfer. If the Audio files size is less than the DMA max
	 * data transfer size, so there is no calculation to be done, just restart
	 * from the beginning of the file ... */
	/* Check if the end of file has been reached */
	__asm volatile (
			"	nop		\n"
	);
#ifdef AUDIO_MAL_MODE_NORMAL
	for (i = 0; i < 32; i++) {
		audiodata[i] = RecBuf[i >> 1];
	}

	EVAL_AUDIO_Play((uint16_t*) (&audiodata[0]), 16 * 2 * 2);
#endif
}

/**
  * @brief  Manages the DMA Half Transfer complete interrupt.
  * @param  None
  * @retval None
  */
void EVAL_AUDIO_HalfTransfer_CallBack(uint32_t pBuffer, uint32_t Size)
{  
#ifdef AUDIO_MAL_MODE_CIRCULAR
  
  /* Display message on the LCD screen */
  LCD_DisplayStringLine(Line8, " 1/2 Buffer Reached "); 
  
#endif /* AUDIO_MAL_MODE_CIRCULAR */
  
  /* Generally this interrupt routine is used to load the buffer when 
  a streaming scheme is used: When first Half buffer is already transferred load 
  the new data to the first half of buffer while DMA is transferring data from 
  the second half. And when Transfer complete occurs, load the second half of 
  the buffer while the DMA is transferring from the first half ... */
  /* 
    ...........
                   */
}
/**
  * @brief  Get next data sample callback
  * @param  None
  * @retval Next data sample to be sent
  */
uint16_t EVAL_AUDIO_GetSampleCallBack_1(void) {
	uint16_t data = 0;
	if (DACTest == 0) {
		if (Left_Right == 0) {
			/* Get the next sample to be sent */
			data = sinebuf[count++];
			if (count == 48) {
				count = 0x00;
			}
			Left_Right = 1;
		} else {
			/* Get the next sample to be sent */
			data = sinebuf[count1++];
			if (count1 == 48) {
				count1 = 0x00;
			}
			Left_Right = 0;
		}
	} else {
		/* Get the next sample to be sent */
		data = 32768 + sinebuf[count++];
		if (count == 48) {
			count = 0x00;
		}
	}
	return data;
}


/**
  * @brief  Manages the DMA FIFO error interrupt.
  * @param  None
  * @retval None
  */
void EVAL_AUDIO_Error_CallBack(void* pData)
{
  /* Stop the program with an infinite loop */
  while (1)
  {}
  
  /* could also generate a system reset to recover from the error */
  /* .... */
}

/*----------------------------------------------------------------------------*/


/******************* (C) COPYRIGHT 2011 STMicroelectronics *****END OF FILE****/
